name: build

on: 
  pull_request:
  push:
    branches: 
      - master

env:
  BUILD_TYPE: Release

jobs:  
  ubuntu-latest:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@master
    - name: install pre-reqs and build
      run: sudo ./install/installUbuntu.sh
    - name: test
      run: |
       ./build/usher --help
       ./build/matUtils --help
       mpirun -np 1 ./build/matOptimize --help
       ./build/ripples --help
       command -v mafft

  macos-14:
    runs-on: macos-14
    steps:
    - uses: actions/checkout@master
    - name: install pre-reqs and build
      run: |
       curl -fsSL https://repo.anaconda.com/miniconda/Miniconda3-latest-MacOSX-arm64.sh -o miniconda.sh  
       bash miniconda.sh -b -p "$HOME/miniconda" 
       rm miniconda.sh 
       export PATH="$HOME/miniconda/bin:$PATH" 
       source "$HOME/miniconda/etc/profile.d/conda.sh"
      ./install/installMacOS.sh
    - name: test
     run: |
       ./build/usher --help
       ./build/matUtils --help
       mpirun -np 1 ./build/matOptimize --help
       ./build/ripples --help
       command -v mafft

